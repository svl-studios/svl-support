(function($){"use strict";var globalCategory="";var devMode;$.trialKev=$.trialKev||{};$(document).ready(function(){devMode=Boolean($("extendify-templates").data("dev"));$.trialKev.buttonHandler();$.trialKev.scrollHandler();$.trialKev.selectHandler();$.trialKev.initPushMenu();$.trialKev.ajaxSearch()});$.trialKev.resetSelects=function(){var style=$(".buttons-right select#style");var pattern=$(".buttons-right select#patterns");var features=$(".buttons-right select#features");style.val("all").prop("selected",true);pattern.val("all").prop("selected",true);features.val("all").prop("selected",true)};$.trialKev.ajaxSearch=function(){if(0===$(".template-search").length){return}$(".template-search #template-search-input").autocomplete({delay:50,position:{collision:"none"},minLength:2,source:function(req){if(true===devMode){console.log(req.term)}$.trialKev.runModeAjax("",globalCategory,req.term)}})};$.trialKev.selectHandler=function(){$(".buttons-right select").on("change",function(){var searchTerm=$(".template-search #template-search-input").val();$.trialKev.runModeAjax("",globalCategory,searchTerm)})};$.trialKev.initPushMenu=function(){$("#extendify-menu").multilevelpushmenu({containersToPush:[$("#content")],backItemIcon:"dashicons dashicons-arrow-right-alt2",groupIcon:"dashicons dashicons-arrow-left-alt2",menuWidth:"250px",onMenuReady:function(){$("#extendify-menu").css("visibility","visible");$(".menu.spinner").addClass("hidden")},onItemClick:function(event,args,clicked){var mode=$(".extendify-templates").data("mode");var searchTerm=$(".template-search #template-search-input").val();globalCategory=clicked.find("a").html().trim();$.trialKev.runModeAjax(mode,globalCategory,searchTerm)}})};$.trialKev.scrollHandler=function(){$(".template-browser").on("scroll",function(){var offset;var currentScroll;var targetScroll;var searchTerm;currentScroll=$(this).scrollTop()+this.clientHeight;targetScroll=this.scrollHeight;if(currentScroll>=targetScroll){$(".ajax-load.spinner").css("visibility","visible");offset=$(".extendify-templates div.templates").data("next-page");searchTerm=$(".template-search #template-search-input").val();$.trialKev.runModeAjax("",globalCategory,searchTerm,offset,true)}})};$.trialKev.appendHTML=function(content){var index;var nextpage;if(content.trim()!==""){index=content.indexOf("</nextpage>");if(-1!==index){nextpage=content.substring(0,content.indexOf("</nextpage>"));nextpage=nextpage.replace("<nextpage>","");$(".extendify-templates .templates").data("next-page",nextpage);content=content.substr(index+11)}$(".content div.templates").append(content)}else{console.log("AJAX called returned nothing.")}$(".ajax-load.spinner").css("visibility","hidden")};$.trialKev.runModeAjax=function(mode,category,term,offset,append){var data;var style=$(".buttons-right select#style :selected").text();var pattern=$(".buttons-right select#patterns :selected").text();var features=$(".buttons-right select#features :selected").text();if(""===append||undefined===append){append=false}if(""===mode){mode=$(".extendify-templates").data("mode")}$(".ajax-load.spinner").css("visibility","visible");if(false===append){$(".wrap-template").remove();$("h2.no-results").remove()}data={action:"set_mode",nonce:templateAjax.nonce,mode:mode,category:category,style:style,pattern:pattern,features:features,term:term,offset:offset,append:append};$.post(templateAjax.ajaxurl,data,function(response){if(true===devMode){console.log(response)}$.trialKev.appendHTML(response)})};$.trialKev.buttonHandler=function(){var templates=$(".extendify-templates .buttons .templates-button");var patterns=$(".extendify-templates .buttons .patterns-button");$("#extendify-menu li.template").addClass("hidden");templates.on("click",function(){var searchTerm;if($(this).hasClass("focus")){return}$(this).addClass("focus");patterns.removeClass("focus");$(".extendify-templates").data("mode","template");$("#extendify-menu li.pattern").addClass("hidden");$("#extendify-menu li.template").removeClass("hidden");$(".buttons .buttons-right .pattern").addClass("hidden");$("#extendify-menu").multilevelpushmenu("collapse","Extendify Library");$.trialKev.resetSelects();searchTerm=$(".template-search #template-search-input").val();$.trialKev.runModeAjax("template","",searchTerm)});patterns.on("click",function(){var searchTerm;if($(this).hasClass("focus")){return}$(this).addClass("focus");templates.removeClass("focus");$(".extendify-templates").data("mode","pattern");$("#extendify-menu li.template").addClass("hidden");$("#extendify-menu li.pattern").removeClass("hidden");$(".buttons .buttons-right .pattern").removeClass("hidden");$("#extendify-menu").multilevelpushmenu("collapse","Extendify Library");$.trialKev.resetSelects();searchTerm=$(".template-search #template-search-input").val();$.trialKev.runModeAjax("pattern","",searchTerm)})}})(jQuery);